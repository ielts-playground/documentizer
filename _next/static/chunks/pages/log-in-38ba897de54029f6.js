(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[720],{7267:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/log-in",function(){return n(8227)}])},648:function(e,t,n){"use strict";n.d(t,{YR:function(){return l},qz:function(){return p},DT:function(){return d},TW:function(){return w},qE:function(){return f},Ch:function(){return h},Ow:function(){return _},Wc:function(){return g},dB:function(){return m}});var a=n(6154),r=n(5885),u=n(3454);let o=new r.Z,s=a.Z.create({baseURL:"https://test.tuanm.dev/v1/api",headers:{"X-Api-Key":u.env.SERVER_API_KEY}}),i=a.Z.create({baseURL:"https://test.tuanm.dev/v1/api"});i.interceptors.request.use(e=>{let t=o.get("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});var c={private:s,default:{...i,clearToken:()=>{o.remove("token")}}};async function l(e,t){let{token:n}=(await c.default.post("/authenticate",{username:e,password:t})).data||{};return n&&o.set("token",n),!!n}async function d(e,t,n){let a=new FormData;for(let r of(a.append("audio",t),a.append("subscription",e),n))a.append(r.skill,new Blob([JSON.stringify(r)],{type:"application/json"}));return(await c.default.put("/test/new",a,{headers:{Authorization:c.default.defaults.headers.Authorization,"Content-Type":"multipart/form-data"}})).data}async function f(){return(await c.default.get("/users")).data}function p(){c.default.clearToken()}async function m(e){return(await c.default.get("/exam/".concat(e,"/test/writing"))).data}async function w(e,t){await c.default.post("/exam/".concat(e,"/evaluate/writing"),{point:t})}async function h(e){return(await c.default.get("/exam/".concat(e,"/result"))).data}async function g(e){return(await c.default.get("/exam/".concat(e,"/answer/writing"))).data}async function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(await c.default.get("/exam/not-graded?page=".concat(e,"&size=").concat(t))).data}},8227:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var a=n(5893),r=n(648),u=n(1163),o=n(7294),s=n(7772),i=n.n(s);function c(){let[e,t]=(0,o.useState)({username:"",password:""}),[n,s]=(0,o.useState)(!1),[c,l]=(0,o.useState)(!1),d=(0,u.useRouter)();(0,o.useEffect)(()=>{if(c){let e=new URLSearchParams(window.location.search);if(e.get("redirect")){let t=decodeURIComponent(e.get("redirect"))||"/home";d.push(t)}else d.push("/home")}else t({username:localStorage.getItem("username"),password:""})},[c]);let f=e=>{let n=e.target.value;t(e=>({...e,username:n})),m()},p=e=>{let n=e.target.value;t(e=>({...e,password:n})),m()};function m(){let e=document.getElementsByTagName("button")[0];function t(t){13===t.keyCode&&(t.preventDefault(),e.click())}let n=document.getElementsByTagName("input");Array.from(n).forEach(e=>{e.addEventListener("keydown",t)})}return(0,a.jsx)("div",{className:i().all,children:(0,a.jsxs)("div",{className:i().box,children:[(0,a.jsx)("input",{className:i().input,type:"text",placeholder:"username",onChange:e=>f(e),defaultValue:e.username}),(0,a.jsx)("input",{className:i().input,type:"password",placeholder:"password",onChange:e=>p(e)}),(0,a.jsx)("button",{className:(null==e?void 0:e.username)&&(null==e?void 0:e.password)&&!n?i().button:i().disabledButton,onClick:function(t){(null==e?void 0:e.username)&&(null==e?void 0:e.password)&&!n&&(s(!0),(0,r.YR)(e.username,e.password).then(t=>{if(l(t),t)localStorage.setItem("username",e.username);else throw Error()}).catch(()=>{alert("Username or password incorrect!"),s(!1)}))},children:n?"Logging in...":"Log in"})]})})}},7772:function(e){e.exports={all:"styles_all__4wEox",box:"styles_box__LIxMc",input:"styles_input__dEIEU",disabledButton:"styles_disabledButton__Jo4EQ",button:"styles_button__jss6n"}}},function(e){e.O(0,[7,774,888,179],function(){return e(e.s=7267)}),_N_E=e.O()}]);